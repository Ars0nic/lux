<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1490.4001px" preserveAspectRatio="none" style="width:1704px;height:1490px;background:#333333;" version="1.1" viewBox="0 0 1704 1490" width="1704.0001px" zoomAndPan="magnify"><defs/><g><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="37.2" x2="37.2" y1="99.3599" y2="241.44"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158; stroke-dasharray: 1.0,4.0;" x1="37.2" x2="37.2" y1="241.44" y2="290.8799"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="37.2" x2="37.2" y1="290.8799" y2="1385.7605"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="162" x2="162" y1="99.3599" y2="241.44"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158; stroke-dasharray: 1.0,4.0;" x1="162" x2="162" y1="241.44" y2="290.8799"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="162" x2="162" y1="290.8799" y2="1385.7605"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="344.4" x2="344.4" y1="99.3599" y2="241.44"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158; stroke-dasharray: 1.0,4.0;" x1="344.4" x2="344.4" y1="241.44" y2="290.8799"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="344.4" x2="344.4" y1="290.8799" y2="1385.7605"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="685.2" x2="685.2" y1="99.3599" y2="241.44"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158; stroke-dasharray: 1.0,4.0;" x1="685.2" x2="685.2" y1="241.44" y2="290.8799"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="685.2" x2="685.2" y1="290.8799" y2="1385.7605"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="1074" x2="1074" y1="99.3599" y2="241.44"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158; stroke-dasharray: 1.0,4.0;" x1="1074" x2="1074" y1="241.44" y2="290.8799"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="1074" x2="1074" y1="290.8799" y2="1385.7605"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="1405.2001" x2="1405.2001" y1="99.3599" y2="241.44"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158; stroke-dasharray: 1.0,4.0;" x1="1405.2001" x2="1405.2001" y1="241.44" y2="290.8799"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="1405.2001" x2="1405.2001" y1="290.8799" y2="1385.7605"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="1568.4001" x2="1568.4001" y1="99.3599" y2="241.44"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158; stroke-dasharray: 1.0,4.0;" x1="1568.4001" x2="1568.4001" y1="241.44" y2="290.8799"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="1568.4001" x2="1568.4001" y1="290.8799" y2="1385.7605"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="1674.0001" x2="1674.0001" y1="99.3599" y2="241.44"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158; stroke-dasharray: 1.0,4.0;" x1="1674.0001" x2="1674.0001" y1="241.44" y2="290.8799"/><line style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" x1="1674.0001" x2="1674.0001" y1="290.8799" y2="1385.7605"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="48" x="9.6" y="94.9079">Alice</text><ellipse cx="37.2" cy="15.6" fill="#6B4C70" rx="9.6" ry="9.6" style="stroke: #000000; stroke-width: 2.4000000953674316;"/><path d="M37.2,25.2 L37.2,57.6 M21.6,34.8 L52.8,34.8 M37.2,57.6 L21.6,75.6 M37.2,57.6 L52.8,75.6 " fill="none" style="stroke: #000000; stroke-width: 2.4000000953674316;"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="48" x="9.6" y="1400.2684">Alice</text><ellipse cx="37.2" cy="1416.7204" fill="#6B4C70" rx="9.6" ry="9.6" style="stroke: #000000; stroke-width: 2.4000000953674316;"/><path d="M37.2,1426.3204 L37.2,1458.7204 M21.6,1435.9204 L52.8,1435.9204 M37.2,1458.7204 L21.6,1476.7204 M37.2,1458.7204 L52.8,1476.7204 " fill="none" style="stroke: #000000; stroke-width: 2.4000000953674316;"/><rect fill="#6B4C70" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="170.4" x="76.8" y="61.2"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="153.6" x="85.2" y="85.3079">Alice's BTC Node</text><rect fill="#6B4C70" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="170.4" x="76.8" y="1384.5605"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="153.6" x="85.2" y="1408.6684">Alice's BTC Node</text><rect fill="#6B4C70" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="170.4" x="259.2" y="61.2"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="153.6" x="267.6" y="85.3079">Alice's LUX Node</text><rect fill="#6B4C70" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="170.4" x="259.2" y="1384.5605"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="153.6" x="267.6" y="1408.6684">Alice's LUX Node</text><rect fill="#6B4C70" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="160.8" x="604.8" y="61.2"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="144" x="613.2" y="85.3079">Alice's Luxgate</text><rect fill="#6B4C70" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="160.8" x="604.8" y="1384.5605"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="144" x="613.2" y="1408.6684">Alice's Luxgate</text><rect fill="#007A74" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="141.6" x="1003.2" y="61.2"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="124.8" x="1011.6" y="85.3079">Bob's Luxgate</text><rect fill="#007A74" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="141.6" x="1003.2" y="1384.5605"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="124.8" x="1011.6" y="1408.6684">Bob's Luxgate</text><rect fill="#007A74" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="151.2" x="1329.6001" y="61.2"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="134.4" x="1338.0001" y="85.3079">Bob's LUX Node</text><rect fill="#007A74" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="151.2" x="1329.6001" y="1384.5605"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="134.4" x="1338.0001" y="1408.6684">Bob's LUX Node</text><rect fill="#007A74" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="151.2" x="1492.8001" y="61.2"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="134.4" x="1501.2001" y="85.3079">Bob's BTC Node</text><rect fill="#007A74" height="36.9599" rx="1.2" ry="1.2" style="stroke: #000000; stroke-width: 1.8000000715255737;" width="151.2" x="1492.8001" y="1384.5605"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="134.4" x="1501.2001" y="1408.6684">Bob's BTC Node</text><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="28.8" x="1656.0001" y="94.9079">Bob</text><ellipse cx="1674.0001" cy="15.6" fill="#007A74" rx="9.6" ry="9.6" style="stroke: #000000; stroke-width: 2.4000000953674316;"/><path d="M1674.0001,25.2 L1674.0001,57.6 M1658.4001,34.8 L1689.6001,34.8 M1674.0001,57.6 L1658.4001,75.6 M1674.0001,57.6 L1689.6001,75.6 " fill="none" style="stroke: #000000; stroke-width: 2.4000000953674316;"/><text fill="#D8D8D8" font-family="Fira Code" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="28.8" x="1656.0001" y="1400.2684">Bob</text><ellipse cx="1674.0001" cy="1416.7204" fill="#007A74" rx="9.6" ry="9.6" style="stroke: #000000; stroke-width: 2.4000000953674316;"/><path d="M1674.0001,1426.3204 L1674.0001,1458.7204 M1658.4001,1435.9204 L1689.6001,1435.9204 M1674.0001,1458.7204 L1658.4001,1476.7204 M1674.0001,1458.7204 L1689.6001,1476.7204 " fill="none" style="stroke: #000000; stroke-width: 2.4000000953674316;"/><polygon fill="#FFFFFF" points="1087.2,132.4799,1075.2,137.2799,1087.2,142.0799,1082.4,137.2799" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="1080" x2="1672.8001" y1="137.2799" y2="137.2799"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="1094.4" y="130.7459">1</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="192" x="1108.8" y="130.7459">Sell Y BTC for X LUX</text><rect fill="#333333" height="27.6" style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" width="134.4" x="1006.8" y="152.8799"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="1011.6" y="172.2659">Create</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="1078.8" y="172.2659">bid_id</text><polygon fill="#FFFFFF" points="698.4,227.04,686.4,231.84,698.4,236.64,693.6,231.84" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="691.2" x2="1072.8" y1="231.84" y2="231.84"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="705.6" y="215.946">2</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="720" y="206.586">Broadcast</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="105.6" x="720" y="225.306">SellNotify(</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="825.6" y="225.306">bid_id</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="172.8" x="883.2" y="225.306">, "BTC\LUX", Y, X)</text><text fill="#D8D8D8" font-family="Fira Code" font-size="13.2" lengthAdjust="spacingAndGlyphs" textLength="42" x="834.6" y="270.5819">After</text><polygon fill="#FFFFFF" points="670.8,311.9999,682.8,316.7999,670.8,321.5999,675.6,316.7999" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="37.2" x2="678" y1="316.7999" y2="316.7999"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="45.6" y="310.2659">3</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="182.4" x="60" y="310.2659">Buy X LUX for Y BTC</text><rect fill="#333333" height="46.8" style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" width="192" x="589.2" y="332.3999"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="182.4" x="594" y="351.7859">Lookup in orderbook</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="594" y="370.5059">Create</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="661.2" y="370.5059">ask_id</text><polygon fill="#FFFFFF" points="1059.6,406.5599,1071.6,411.3599,1059.6,416.1599,1064.4,411.3599" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="685.2" x2="1066.8" y1="411.3599" y2="411.3599"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="693.6" y="404.8259">4</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="38.4" x="708" y="404.8259">Buy(</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="746.4" y="404.8259">bid_id</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="804" y="404.8259">,</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="823.2" y="404.8259">ask_id</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="172.8" x="880.8" y="404.8259">, "LUX/BTC", X, Y)</text><polygon fill="#FFFFFF" points="698.4,442.08,686.4,446.88,698.4,451.68,693.6,446.88" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="691.2" x2="1072.8" y1="446.88" y2="446.88"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="705.6" y="440.346">5</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="720" y="440.346">Match(</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="777.6" y="440.346">ask_id</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="835.2" y="440.346">,</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="854.4" y="440.346">bid_id</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="912" y="440.346">)</text><polygon fill="#FFFFFF" points="175.2,477.6,163.2,482.4,175.2,487.2,170.4,482.4" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="168" x2="684" y1="482.4" y2="482.4"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="182.4" y="475.866">6</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="144" x="196.8" y="475.866">GenerateAddress</text><polygon fill="#FFFFFF" points="670.8,513.12,682.8,517.92,670.8,522.72,675.6,517.92" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="162" x2="678" y1="517.92" y2="517.92"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="170.4" y="511.386">7</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="184.8" y="511.386">addressBTC</text><polygon fill="#FFFFFF" points="1390.8001,548.64,1402.8001,553.44,1390.8001,558.24,1395.6001,553.44" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="1074" x2="1398.0001" y1="553.44" y2="553.44"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="1082.4" y="546.906">8</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="144" x="1096.8" y="546.906">GenerateAddress</text><polygon fill="#FFFFFF" points="1087.2,584.16,1075.2,588.96,1087.2,593.76,1082.4,588.96" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="1080" x2="1404.0001" y1="588.96" y2="588.96"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="1094.4" y="582.426">9</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="1108.8" y="582.426">addressLUX</text><polygon fill="#FFFFFF" points="1059.6,619.68,1071.6,624.48,1059.6,629.28,1064.4,624.48" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="685.2" x2="1066.8" y1="624.48" y2="624.48"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="693.6" y="617.946">10</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="96" x="717.6" y="617.946">StartSwap(</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="813.6" y="617.946">order_id</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="890.4" y="617.946">,</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="909.6" y="617.946">addressBTC</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="1005.6" y="617.946">)</text><polygon fill="#FFFFFF" points="698.4,655.2001,686.4,660.0001,698.4,664.8001,693.6,660.0001" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="691.2" x2="1072.8" y1="660.0001" y2="660.0001"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="705.6" y="653.4661">11</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="729.6" y="653.4661">addressLUX</text><rect fill="#333333" height="27.6" style="stroke: #D8D8D8; stroke-width: 1.2000000476837158;" width="153.6" x="997.2" y="675.6001"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="1002" y="694.9861">Generate</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="1088.4" y="694.9861">secret</text><polygon fill="#FFFFFF" points="1554.0001,749.7601,1566.0001,754.5601,1554.0001,759.3601,1558.8001,754.5601" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="1074" x2="1561.2001" y1="754.5601" y2="754.5601"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="1082.4" y="738.6661">12</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="307.2" x="1106.4" y="729.3061">Create contract sending Y BTC to</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="1423.2001" y="729.3061">addressBTC</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="48" x="1106.4" y="748.0261">using</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="1164" y="748.0261">secretHash</text><polygon fill="#FFFFFF" points="1087.2,804.0002,1075.2,808.8002,1087.2,813.6002,1082.4,808.8002" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="1080" x2="1567.2001" y1="808.8002" y2="808.8002"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="1094.4" y="792.9061">13</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67.2" x="1118.4" y="783.5461">txidBTC</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="1118.4" y="802.2662">Verify tx</text><polygon fill="#FFFFFF" points="698.4,839.5202,686.4,844.3202,698.4,849.1202,693.6,844.3202" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="691.2" x2="1072.8" y1="844.3202" y2="844.3202"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="705.6" y="837.7862">14</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67.2" x="729.6" y="837.7862">txidBTC</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="796.8" y="837.7862">,</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="816" y="837.7862">secretHash</text><polygon fill="#FFFFFF" points="175.2,875.0402,163.2,879.8402,175.2,884.6402,170.4,879.8402" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="168" x2="684" y1="879.8402" y2="879.8402"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="182.4" y="873.3062">15</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="206.4" y="873.3062">Verify tx</text><polygon fill="#FFFFFF" points="670.8,910.5602,682.8,915.3602,670.8,920.1602,675.6,915.3602" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="162" x2="678" y1="915.3602" y2="915.3602"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="170.4" y="908.8262">16</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="0" x="204" y="908.8262"/><polygon fill="#FFFFFF" points="357.6,964.8002,345.6,969.6002,357.6,974.4002,352.8,969.6002" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="350.4" x2="684" y1="969.6002" y2="969.6002"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="364.8" y="953.7062">17</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="278.4" x="388.8" y="944.3462">Create contract sending X LUX</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="388.8" y="963.0662">to</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="417.6" y="963.0662">addressLUX</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="48" x="523.2" y="963.0662">using</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="580.8" y="963.0662">secretHash</text><polygon fill="#FFFFFF" points="670.8,1019.0403,682.8,1023.8403,670.8,1028.6403,675.6,1023.8403" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="344.4" x2="678" y1="1023.8403" y2="1023.8403"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="352.8" y="1007.9463">18</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67.2" x="376.8" y="998.5863">txidLUX</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="376.8" y="1017.3063">Verify tx</text><polygon fill="#FFFFFF" points="1059.6,1054.5603,1071.6,1059.3603,1059.6,1064.1603,1064.4,1059.3603" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="685.2" x2="1066.8" y1="1059.3603" y2="1059.3603"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="693.6" y="1052.8263">19</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67.2" x="717.6" y="1052.8263">txidLUX</text><polygon fill="#FFFFFF" points="1554.0001,1090.0803,1566.0001,1094.8803,1554.0001,1099.6803,1558.8001,1094.8803" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="1074" x2="1561.2001" y1="1094.8803" y2="1094.8803"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="1082.4" y="1088.3463">20</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="1106.4" y="1088.3463">Verify tx</text><polygon fill="#FFFFFF" points="1087.2,1125.6003,1075.2,1130.4003,1087.2,1135.2003,1082.4,1130.4003" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="1080" x2="1567.2001" y1="1130.4003" y2="1130.4003"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="1094.4" y="1123.8663">21</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="0" x="1128" y="1123.8663"/><polygon fill="#FFFFFF" points="1390.8001,1161.1204,1402.8001,1165.9204,1390.8001,1170.7204,1395.6001,1165.9204" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="1074" x2="1398.0001" y1="1165.9204" y2="1165.9204"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="1082.4" y="1159.3863">22</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="211.2" x="1106.4" y="1159.3863">Spend LUX UTXO's using</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="1327.2001" y="1159.3863">secret</text><polygon fill="#FFFFFF" points="1087.2,1196.6404,1075.2,1201.4404,1087.2,1206.2404,1082.4,1201.4404" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="1080" x2="1404.0001" y1="1201.4404" y2="1201.4404"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="1094.4" y="1194.9064">23</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="1118.4" y="1194.9064">Verify tx</text><polygon fill="#FFFFFF" points="698.4,1250.8804,686.4,1255.6804,698.4,1260.4804,693.6,1255.6804" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="691.2" x2="1072.8" y1="1255.6804" y2="1255.6804"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="705.6" y="1239.7864">24</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="729.6" y="1230.4264">Broadcast</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="0" x="825.6" y="1230.4264"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="192" x="729.6" y="1249.1464">SellCompletedNotify(</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="921.6" y="1249.1464">bid_id</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="9.6" x="979.2" y="1249.1464">)</text><polygon fill="#FFFFFF" points="357.6,1305.1204,345.6,1309.9204,357.6,1314.7204,352.8,1309.9204" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="350.4" x2="684" y1="1309.9204" y2="1309.9204"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="364.8" y="1294.0264">25</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="230.4" x="388.8" y="1284.6664">Find Bob's spent tx outs</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="388.8" y="1303.3864">and find</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="475.2" y="1303.3864">secret</text><polygon fill="#FFFFFF" points="175.2,1359.3605,163.2,1364.1605,175.2,1368.9605,170.4,1364.1605" style="stroke: #FFFFFF; stroke-width: 1.2000000476837158;"/><line style="stroke: #FFFFFF; stroke-width: 2.4000000953674316;" x1="168" x2="684" y1="1364.1605" y2="1364.1605"/><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19.2" x="182.4" y="1348.2665">26</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="153.6" x="206.4" y="1338.9065">Spend BTC UTXO's</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="48" x="206.4" y="1357.6265">using</text><text fill="#D8D8D8" font-family="Fira Code" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="264" y="1357.6265">secret</text><!--
@startuml


skinparam shadowing false
skinparam defaultFontColor #d8d8d8
skinparam defaultFontName "Fira Code"
skinparam BackgroundColor #333333
skinparam sequenceArrowThickness 2
skinparam roundcorner 2
skinparam ParticipantBorderColor #black
skinparam NoteBackgroundColor #333333
skinparam NoteBorderColor  #d8d8d8
skinparam sequence {
    ArrowColor #white
    LifeLineBorderColor #d8d8d8
    ActorBorderColor #black
}

actor Alice #6b4c70
participant btcA as "Alice's BTC Node"  #6b4c70
participant luxA as "Alice's LUX Node"  #6b4c70
participant lgA as "Alice's Luxgate" #6b4c70
participant lgB as "Bob's Luxgate"  #007a74
participant luxB as "Bob's LUX Node"  #007a74
participant btcB as "Bob's BTC Node"  #007a74
actor Bob  #007a74

autonumber

Bob -> lgB : Sell Y BTC for X LUX
rnote over lgB : Create **bid_id**
lgB -> lgA : //Broadcast//\nSellNotify(**bid_id**, "BTC\LUX", Y, X)
... After ...
Alice -> lgA : Buy X LUX for Y BTC

rnote over lgA
Lookup in orderbook
Create **ask_id**
endrnote

lgA -> lgB : Buy(**bid_id**, **ask_id**, "LUX/BTC", X, Y)
lgB -> lgA : Match(**ask_id**, **bid_id**)

lgA -> btcA :  GenerateAddress
btcA -> lgA :  **addressBTC**

lgB -> luxB : GenerateAddress
luxB -> lgB : **addressLUX**

lgA -> lgB : StartSwap(**order_id**, **addressBTC**)
lgB -> lgA : **addressLUX**

rnote over lgB : Generate **secret**

lgB -> btcB : Create contract sending Y BTC to **addressBTC**\nusing **secretHash**
btcB -> lgB : **txidBTC**\nVerify tx

lgB -> lgA : **txidBTC**, **secretHash**

lgA -> btcA : Verify tx
btcA -> lgA

lgA -> luxA : Create contract sending X LUX\nto **addressLUX** using **secretHash**
luxA -> lgA : **txidLUX**\nVerify tx

lgA -> lgB : **txidLUX**


lgB -> btcB : Verify tx
btcB -> lgB

lgB -> luxB : Spend LUX UTXO's using **secret**

luxB -> lgB : Verify tx

lgB -> lgA : //Broadcast// \nSellCompletedNotify(**bid_id**)

lgA -> luxA : Find Bob's spent tx outs\nand find **secret**
lgA -> btcA : Spend BTC UTXO's\nusing **secret**

@enduml

PlantUML version 1.2018.09(Fri Jul 27 23:58:18 NOVT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1248-b8
Operating System: Linux
OS Version: 4.15.0-33-generic
Default Encoding: UTF-8
Language: ru
Country: RU
--></g></svg>