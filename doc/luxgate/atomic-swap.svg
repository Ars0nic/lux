<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2421px" preserveAspectRatio="none" style="width:1495px;height:2421px;background:#333333;" version="1.1" viewBox="0 0 1495 2421" width="1495px" zoomAndPan="magnify"><defs/><g><rect fill="#333333" height="114.7481" style="stroke: #D8D8D8; stroke-width: 2.0;" width="355.5" x="961.5" y="1505.5985"/><rect fill="#333333" height="114.7481" style="stroke: #D8D8D8; stroke-width: 2.0;" width="619.5" x="45" y="1904.6537"/><rect fill="#333333" height="70.874" style="stroke: #D8D8D8; stroke-width: 2.0;" width="493" x="961.5" y="2124.2128"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="26" x2="26" y1="98.1719" y2="400.479"/><line style="stroke: #D8D8D8; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="26" x2="26" y1="400.479" y2="441.1179"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="26" x2="26" y1="441.1179" y2="2317.8348"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="115" x2="115" y1="98.1719" y2="400.479"/><line style="stroke: #D8D8D8; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="115" x2="115" y1="400.479" y2="441.1179"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="115" x2="115" y1="441.1179" y2="2317.8348"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="244" x2="244" y1="98.1719" y2="400.479"/><line style="stroke: #D8D8D8; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="244" x2="244" y1="400.479" y2="441.1179"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="244" x2="244" y1="441.1179" y2="2317.8348"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="600.5" x2="600.5" y1="98.1719" y2="400.479"/><line style="stroke: #D8D8D8; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="600.5" x2="600.5" y1="400.479" y2="441.1179"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="600.5" x2="600.5" y1="441.1179" y2="2317.8348"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="811" x2="811" y1="98.1719" y2="400.479"/><line style="stroke: #D8D8D8; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="811" x2="811" y1="400.479" y2="441.1179"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="811" x2="811" y1="441.1179" y2="2317.8348"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="1022.5" x2="1022.5" y1="98.1719" y2="400.479"/><line style="stroke: #D8D8D8; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1022.5" x2="1022.5" y1="400.479" y2="441.1179"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="1022.5" x2="1022.5" y1="441.1179" y2="2317.8348"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="1250" x2="1250" y1="98.1719" y2="400.479"/><line style="stroke: #D8D8D8; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1250" x2="1250" y1="400.479" y2="441.1179"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="1250" x2="1250" y1="441.1179" y2="2317.8348"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="1387.5" x2="1387.5" y1="98.1719" y2="400.479"/><line style="stroke: #D8D8D8; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1387.5" x2="1387.5" y1="400.479" y2="441.1179"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="1387.5" x2="1387.5" y1="441.1179" y2="2317.8348"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="1469.5" x2="1469.5" y1="98.1719" y2="400.479"/><line style="stroke: #D8D8D8; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1469.5" x2="1469.5" y1="400.479" y2="441.1179"/><line style="stroke: #D8D8D8; stroke-width: 1.0;" x1="1469.5" x2="1469.5" y1="441.1179" y2="2317.8348"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="8" y="95.5259">Alice</text><ellipse cx="26.5" cy="29.0859" fill="#6B4C70" rx="8" ry="8" style="stroke: #000000; stroke-width: 2.0;"/><path d="M26.5,37.0859 L26.5,64.0859 M13.5,45.0859 L39.5,45.0859 M26.5,64.0859 L13.5,79.0859 M26.5,64.0859 L39.5,79.0859 " fill="#6B4C70" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="8" y="2330.2748">Alice</text><ellipse cx="26.5" cy="2342.9208" fill="#6B4C70" rx="8" ry="8" style="stroke: #000000; stroke-width: 2.0;"/><path d="M26.5,2350.9208 L26.5,2377.9208 M13.5,2358.9208 L39.5,2358.9208 M26.5,2377.9208 L13.5,2392.9208 M26.5,2377.9208 L39.5,2392.9208 " fill="#6B4C70" style="stroke: #000000; stroke-width: 2.0;"/><rect fill="#6B4C70" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="120" x="55" y="67.0859"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="62" y="87.5259">Alice's BTC Node</text><rect fill="#6B4C70" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="120" x="55" y="2316.8348"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="62" y="2337.2748">Alice's BTC Node</text><rect fill="#6B4C70" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="119" x="185" y="67.0859"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="192" y="87.5259">Alice's LUX Node</text><rect fill="#6B4C70" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="119" x="185" y="2316.8348"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="192" y="2337.2748">Alice's LUX Node</text><rect fill="#6B4C70" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="108" x="546.5" y="67.0859"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="553.5" y="87.5259">Alice's Luxgate</text><rect fill="#6B4C70" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="108" x="546.5" y="2316.8348"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="553.5" y="2337.2748">Alice's Luxgate</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="791.5" y="79.4399">Carol</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="778" y="95.5259">(Luxgate)</text><ellipse cx="811.5" cy="13" fill="#888888" rx="8" ry="8" style="stroke: #000000; stroke-width: 2.0;"/><path d="M811.5,21 L811.5,48 M798.5,29 L824.5,29 M811.5,48 L798.5,63 M811.5,48 L824.5,63 " fill="#888888" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="791.5" y="2330.2748">Carol</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="778" y="2346.3607">(Luxgate)</text><ellipse cx="811.5" cy="2359.0067" fill="#888888" rx="8" ry="8" style="stroke: #000000; stroke-width: 2.0;"/><path d="M811.5,2367.0067 L811.5,2394.0067 M798.5,2375.0067 L824.5,2375.0067 M811.5,2394.0067 L798.5,2409.0067 M811.5,2394.0067 L824.5,2409.0067 " fill="#888888" style="stroke: #000000; stroke-width: 2.0;"/><rect fill="#007A74" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="102" x="971.5" y="67.0859"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="978.5" y="87.5259">Bob's Luxgate</text><rect fill="#007A74" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="102" x="971.5" y="2316.8348"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="978.5" y="2337.2748">Bob's Luxgate</text><rect fill="#007A74" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="113" x="1194" y="67.0859"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="1201" y="87.5259">Bob's LUX Node</text><rect fill="#007A74" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="113" x="1194" y="2316.8348"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="1201" y="2337.2748">Bob's LUX Node</text><rect fill="#007A74" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="114" x="1330.5" y="67.0859"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="1337.5" y="87.5259">Bob's BTC Node</text><rect fill="#007A74" height="30.0859" rx="1" ry="1" style="stroke: #000000; stroke-width: 1.5;" width="114" x="1330.5" y="2316.8348"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="1337.5" y="2337.2748">Bob's BTC Node</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="25" x="1454.5" y="95.5259">Bob</text><ellipse cx="1470" cy="29.0859" fill="#007A74" rx="8" ry="8" style="stroke: #000000; stroke-width: 2.0;"/><path d="M1470,37.0859 L1470,64.0859 M1457,45.0859 L1483,45.0859 M1470,64.0859 L1457,79.0859 M1470,64.0859 L1483,79.0859 " fill="#007A74" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="25" x="1454.5" y="2330.2748">Bob</text><ellipse cx="1470" cy="2342.9208" fill="#007A74" rx="8" ry="8" style="stroke: #000000; stroke-width: 2.0;"/><path d="M1470,2350.9208 L1470,2377.9208 M1457,2358.9208 L1483,2358.9208 M1470,2377.9208 L1457,2392.9208 M1470,2377.9208 L1483,2392.9208 " fill="#007A74" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#FFFFFF" points="1033.5,139.1719,1023.5,143.1719,1033.5,147.1719,1029.5,143.1719" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1027.5" x2="1469" y1="143.1719" y2="143.1719"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="1039.5" y="132.1204">1</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78" x="1051.5" y="124.6519">createorder</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="1132.5" y="124.6519">(rpc)</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1051.5" y="139.5889">Y BTC - X LUX</text><rect fill="#333333" height="22" style="stroke: #D8D8D8; stroke-width: 1.0;" width="118" x="963" y="157.0459"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="967" y="173.5259">Save order locally</text><polygon fill="#333333" points="1005,189.9829,1040,189.9829,1050,200.9829,1040,211.9829,1005,211.9829,995,200.9829,1005,189.9829" style="stroke: #D8D8D8; stroke-width: 1.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="1007" y="206.4629">NEW</text><polygon fill="#FFFFFF" points="1458,233.9199,1468,237.9199,1458,241.9199,1462,237.9199" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1022.5" x2="1464" y1="237.9199" y2="237.9199"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="1029.5" y="234.3999">2</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="15" x="1041.5" y="234.3999">ok</text><polygon fill="#FFFFFF" points="822.5,277.8569,812.5,281.8569,822.5,285.8569,818.5,281.8569" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="816.5" x2="1021.5" y1="281.8569" y2="281.8569"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="828.5" y="270.8054">3</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78" x="840.5" y="263.3369">createorder</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="840.5" y="278.274">BTC\LUX, Y, X, Bob's address</text><rect fill="#333333" height="22" style="stroke: #D8D8D8; stroke-width: 1.0;" width="232" x="695" y="295.731"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="699" y="312.211">Relay if no matches with local orders</text><polygon fill="#FFFFFF" points="611.5,354.668,601.5,358.668,611.5,362.668,607.5,358.668" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="605.5" x2="810.5" y1="358.668" y2="358.668"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="617.5" y="347.6165">4</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78" x="629.5" y="340.148">createorder</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="629.5" y="355.085">BTC\LUX, Y, X, Bob's address</text><rect fill="#333333" height="22" style="stroke: #D8D8D8; stroke-width: 1.0;" width="135" x="533" y="372.542"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="537" y="389.022">Relay to other peers</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="735.25" y="425.0389">After</text><polygon fill="#FFFFFF" points="588.5,472.1179,598.5,476.1179,588.5,480.1179,592.5,476.1179" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="26.5" x2="594.5" y1="476.1179" y2="476.1179"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="33.5" y="465.0664">5</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78" x="45.5" y="457.5979">createorder</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="126.5" y="457.5979">(rpc)</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="45.5" y="472.5349">X LUX - Y BTC</text><rect fill="#333333" height="22" style="stroke: #D8D8D8; stroke-width: 1.0;" width="118" x="541" y="489.9919"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="545" y="506.472">Save order locally</text><polygon fill="#333333" points="583,522.929,618,522.929,628,533.929,618,544.929,583,544.929,573,533.929,583,522.929" style="stroke: #D8D8D8; stroke-width: 1.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="585" y="539.409">NEW</text><polygon fill="#FFFFFF" points="37.5,566.866,27.5,570.866,37.5,574.866,33.5,570.866" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="31.5" x2="599.5" y1="570.866" y2="570.866"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="43.5" y="567.346">6</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="15" x="55.5" y="567.346">ok</text><polygon fill="#FFFFFF" points="799.5,610.803,809.5,614.803,799.5,618.803,803.5,614.803" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="600.5" x2="805.5" y1="614.803" y2="614.803"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="607.5" y="603.7515">7</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78" x="619.5" y="596.283">createorder</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="619.5" y="611.22">BTC\LUX, Y, X, Alice's address</text><rect fill="#333333" height="22" style="stroke: #D8D8D8; stroke-width: 1.0;" width="232" x="695" y="628.677"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="699" y="645.157">Relay if no matches with local orders</text><polygon fill="#FFFFFF" points="1010.5,687.614,1020.5,691.614,1010.5,695.614,1014.5,691.614" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="811.5" x2="1016.5" y1="691.614" y2="691.614"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="818.5" y="680.5625">8</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78" x="830.5" y="673.094">createorder</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="830.5" y="688.031">BTC\LUX, Y, X, Alice's address</text><rect fill="#333333" height="22" style="stroke: #D8D8D8; stroke-width: 1.0;" width="157" x="944" y="705.4881"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="149" x="948" y="721.9681">Match with local order!</text><polygon fill="#FFFFFF" points="1238.5,749.4251,1248.5,753.4251,1238.5,757.4251,1242.5,753.4251" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1022.5" x2="1244.5" y1="753.4251" y2="753.4251"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="1029.5" y="749.9051">9</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="55" x="1041.5" y="749.9051">addnode</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="1096.5" y="749.9051">(Alice's address)</text><polygon fill="#FFFFFF" points="255.5,778.3621,245.5,782.3621,255.5,786.3621,251.5,782.3621" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="249.5" x2="1249.5" y1="782.3621" y2="782.3621"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="261.5" y="778.8421">10</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="281.5" y="778.8421">connect, versions exhange</text><polygon fill="#FFFFFF" points="1238.5,807.2991,1248.5,811.2991,1238.5,815.2991,1242.5,811.2991" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="244.5" x2="1244.5" y1="811.2991" y2="811.2991"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="251.5" y="807.7791">11</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="271.5" y="807.7791">connect, versions exhange</text><polygon fill="#FFFFFF" points="1033.5,836.2361,1023.5,840.2361,1033.5,844.2361,1029.5,840.2361" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1027.5" x2="1249.5" y1="840.2361" y2="840.2361"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1039.5" y="836.7161">12</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="15" x="1059.5" y="836.7161">ok</text><polygon fill="#FFFFFF" points="611.5,880.1731,601.5,884.1731,611.5,888.1731,607.5,884.1731" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="605.5" x2="1021.5" y1="884.1731" y2="884.1731"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="617.5" y="873.1216">13</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="76" x="637.5" y="865.6531">ordermatch</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="637.5" y="880.5901">local order</text><polygon fill="#333333" points="969,898.0471,1075,898.0471,1085,909.0471,1075,920.0471,969,920.0471,959,909.0471,969,898.0471" style="stroke: #D8D8D8; stroke-width: 1.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="971" y="914.5272">MATCH_FOUND</text><polygon fill="#FFFFFF" points="126,941.9842,116,945.9842,126,949.9842,122,945.9842" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="120" x2="599.5" y1="945.9842" y2="945.9842"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="132" y="942.4642">14</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="152" y="942.4642">getnewaddress</text><polygon fill="#FFFFFF" points="588.5,970.9212,598.5,974.9212,588.5,978.9212,592.5,974.9212" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="115" x2="594.5" y1="974.9212" y2="974.9212"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="122" y="971.4012">15</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="142" y="971.4012">alice_btc_addr</text><polygon fill="#FFFFFF" points="1010.5,1014.8582,1020.5,1018.8582,1010.5,1022.8582,1014.5,1018.8582" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="600.5" x2="1016.5" y1="1018.8582" y2="1018.8582"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="607.5" y="1007.8067">16</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="55" x="627.5" y="1000.3382">reqswap</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="627.5" y="1015.2752">local order, alice_btc_addr</text><polygon fill="#333333" points="536,1032.7322,664,1032.7322,674,1043.7322,664,1054.7322,536,1054.7322,526,1043.7322,536,1032.7322" style="stroke: #D8D8D8; stroke-width: 1.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="538" y="1049.2122">SWAP_REQUESTED</text><polygon fill="#FFFFFF" points="1238.5,1076.6692,1248.5,1080.6692,1238.5,1084.6692,1242.5,1080.6692" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1022.5" x2="1244.5" y1="1080.6692" y2="1080.6692"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1029.5" y="1077.1492">17</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="1049.5" y="1077.1492">getnewaddress</text><polygon fill="#FFFFFF" points="1033.5,1105.6062,1023.5,1109.6062,1033.5,1113.6062,1029.5,1109.6062" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1027.5" x2="1249.5" y1="1109.6062" y2="1109.6062"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1039.5" y="1106.0863">18</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="1059.5" y="1106.0863">bob_lux_addr</text><polygon fill="#FFFFFF" points="611.5,1149.5433,601.5,1153.5433,611.5,1157.5433,607.5,1153.5433" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="605.5" x2="1021.5" y1="1153.5433" y2="1153.5433"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="617.5" y="1142.4918">19</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="637.5" y="1135.0233">reqswapack</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="637.5" y="1149.9603">local order, bob_lux_addr</text><polygon fill="#333333" points="985,1167.4173,1060,1167.4173,1070,1178.4173,1060,1189.4173,985,1189.4173,975,1178.4173,985,1167.4173" style="stroke: #D8D8D8; stroke-width: 1.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="987" y="1183.8973">SWAP_ACK</text><rect fill="#333333" height="22" style="stroke: #D8D8D8; stroke-width: 1.0;" width="111" x="545" y="1200.3543"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="549" y="1216.8343">Generate</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="610" y="1216.8343">secret</text><polygon fill="#FFFFFF" points="255.5,1244.2913,245.5,1248.2913,255.5,1252.2913,251.5,1248.2913" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="249.5" x2="599.5" y1="1248.2913" y2="1248.2913"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="261.5" y="1244.7713">20</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="281.5" y="1244.7713">getnewaddress</text><polygon fill="#FFFFFF" points="588.5,1273.2283,598.5,1277.2283,588.5,1281.2283,592.5,1277.2283" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="244.5" x2="594.5" y1="1277.2283" y2="1277.2283"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="251.5" y="1273.7083">21</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="271.5" y="1273.7083">alice_lux_refund_addr</text><polygon fill="#FFFFFF" points="255.5,1332.1653,245.5,1336.1653,255.5,1340.1653,251.5,1336.1653" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="249.5" x2="599.5" y1="1336.1653" y2="1336.1653"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="261.5" y="1317.5824">22</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="281.5" y="1302.6453">Create tx with p2sh sending X LUX to</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86" x="507.5" y="1302.6453">bob_lux_addr</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="281.5" y="1317.5824">using</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74" x="315.5" y="1317.5824">secretHash</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="281.5" y="1332.5194">or refunding to</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="375.5" y="1332.5194">alice_lux_refund_addr</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="520.5" y="1332.5194">after 40h</text><polygon fill="#FFFFFF" points="588.5,1360.9764,598.5,1364.9764,588.5,1368.9764,592.5,1364.9764" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="244.5" x2="594.5" y1="1364.9764" y2="1364.9764"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="251.5" y="1361.4564">23</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="271.5" y="1361.4564">txidLUX</text><polygon fill="#FFFFFF" points="1010.5,1419.9134,1020.5,1423.9134,1010.5,1427.9134,1014.5,1423.9134" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="600.5" x2="1016.5" y1="1423.9134" y2="1423.9134"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="607.5" y="1405.3304">24</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="75" x="627.5" y="1390.3934">swccreated</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="627.5" y="1405.3304">local_order, txidLUX, secretHash,</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="627.5" y="1420.2674">alice_lux_refund_addr, p2sh_redeemScript</text><polygon fill="#333333" points="530,1437.7244,671,1437.7244,681,1448.7244,671,1459.7244,530,1459.7244,520,1448.7244,530,1437.7244" style="stroke: #D8D8D8; stroke-width: 1.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="532" y="1454.2044">CONTRACT_CREATED</text><polygon fill="#333333" points="948,1470.6614,1097,1470.6614,1107,1481.6614,1097,1492.6614,948,1492.6614,938,1481.6614,948,1470.6614" style="stroke: #D8D8D8; stroke-width: 1.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="145" x="950" y="1487.1415">CONTRACT_VERIFYING</text><rect fill="none" height="114.7481" style="stroke: #D8D8D8; stroke-width: 2.0;" width="355.5" x="961.5" y="1505.5985"/><polygon fill="#EEEEEE" points="961.5,1505.5985,1050.5,1505.5985,1050.5,1511.5985,1040.5,1521.5985,961.5,1521.5985,961.5,1505.5985" style="stroke: #D8D8D8; stroke-width: 2.0;"/><text fill="#333333" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="976.5" y="1519.0785">Polling</text><polygon fill="#FFFFFF" points="1238.5,1553.5355,1248.5,1557.5355,1238.5,1561.5355,1242.5,1557.5355" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1022.5" x2="1244.5" y1="1557.5355" y2="1557.5355"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1029.5" y="1546.484">25</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="1049.5" y="1539.0155">Verify txidLUX</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="1049.5" y="1553.9525">getrawtransaction</text><polygon fill="#FFFFFF" points="1033.5,1582.4095,1023.5,1586.4095,1033.5,1590.4095,1029.5,1586.4095" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1027.5" x2="1249.5" y1="1586.4095" y2="1586.4095"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1039.5" y="1582.8895">26</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="1059.5" y="1582.8895">confirmations</text><polygon fill="#FFFFFF" points="1375.5,1643.3465,1385.5,1647.3465,1375.5,1651.3465,1379.5,1647.3465" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1022.5" x2="1381.5" y1="1647.3465" y2="1647.3465"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1029.5" y="1643.8265">27</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="1049.5" y="1643.8265">getnewaddress</text><polygon fill="#FFFFFF" points="1033.5,1672.2835,1023.5,1676.2835,1033.5,1680.2835,1029.5,1676.2835" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1027.5" x2="1386.5" y1="1676.2835" y2="1676.2835"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1039.5" y="1672.7635">28</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="1059.5" y="1672.7635">bob_btc_refund_addr</text><polygon fill="#FFFFFF" points="1375.5,1731.2205,1385.5,1735.2205,1375.5,1739.2205,1379.5,1735.2205" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1022.5" x2="1381.5" y1="1735.2205" y2="1735.2205"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1029.5" y="1716.6376">29</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="1049.5" y="1701.7006">Create tx with p2sh sending Y BTC to</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="1276.5" y="1701.7006">alice_btc_addr</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="1049.5" y="1716.6376">using</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74" x="1083.5" y="1716.6376">secretHash</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="1049.5" y="1731.5746">or refunding to</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="1143.5" y="1731.5746">bob_btc_refund_addr</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="1284.5" y="1731.5746">after 40h</text><polygon fill="#FFFFFF" points="1033.5,1760.0316,1023.5,1764.0316,1033.5,1768.0316,1029.5,1764.0316" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1027.5" x2="1386.5" y1="1764.0316" y2="1764.0316"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1039.5" y="1760.5116">30</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="1059.5" y="1760.5116">txidBTC</text><polygon fill="#FFFFFF" points="611.5,1818.9686,601.5,1822.9686,611.5,1826.9686,607.5,1822.9686" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="605.5" x2="1021.5" y1="1822.9686" y2="1822.9686"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="617.5" y="1804.3856">31</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47" x="637.5" y="1789.4486">swcack</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="637.5" y="1804.3856">local_order, txidBTC,</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="637.5" y="1819.3226">bob_btc_refund_addr, p2sh_redeemScript</text><polygon fill="#333333" points="969,1836.7796,1076,1836.7796,1086,1847.7796,1076,1858.7796,969,1858.7796,959,1847.7796,969,1836.7796" style="stroke: #D8D8D8; stroke-width: 1.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103" x="971" y="1853.2596">CONTRACT_ACK</text><polygon fill="#333333" points="509,1869.7167,691,1869.7167,701,1880.7167,691,1891.7167,509,1891.7167,499,1880.7167,509,1869.7167" style="stroke: #D8D8D8; stroke-width: 1.0;"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="511" y="1886.1967">CONTRACT_ACK_VERIFYING</text><rect fill="none" height="114.7481" style="stroke: #D8D8D8; stroke-width: 2.0;" width="619.5" x="45" y="1904.6537"/><polygon fill="#EEEEEE" points="45,1904.6537,134,1904.6537,134,1910.6537,124,1920.6537,45,1920.6537,45,1904.6537" style="stroke: #D8D8D8; stroke-width: 2.0;"/><text fill="#333333" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="60" y="1918.1337">Polling</text><polygon fill="#FFFFFF" points="126,1952.5907,116,1956.5907,126,1960.5907,122,1956.5907" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="120" x2="599.5" y1="1956.5907" y2="1956.5907"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="132" y="1945.5392">32</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="152" y="1938.0707">Verify txidBTC</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="152" y="1953.0077">getrawtransaction</text><polygon fill="#FFFFFF" points="588.5,1981.4647,598.5,1985.4647,588.5,1989.4647,592.5,1985.4647" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="115" x2="594.5" y1="1985.4647" y2="1985.4647"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="122" y="1981.9447">33</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="142" y="1981.9447">confirmations</text><polygon fill="#FFFFFF" points="126,2042.4017,116,2046.4017,126,2050.4017,122,2046.4017" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="120" x2="599.5" y1="2046.4017" y2="2046.4017"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="132" y="2042.8817">34</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="152" y="2042.8817">Create tx that claims</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="285" y="2042.8817">txidBTC</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="338" y="2042.8817">with the</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="392" y="2042.8817">secret</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="437" y="2042.8817">in scriptSig</text><polygon fill="#FFFFFF" points="588.5,2071.3387,598.5,2075.3387,588.5,2079.3387,592.5,2075.3387" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="115" x2="594.5" y1="2075.3387" y2="2075.3387"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="122" y="2071.8187">35</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="142" y="2071.8187">claimTxid</text><rect fill="#333333" height="22" style="stroke: #D8D8D8; stroke-width: 1.0;" width="100" x="550" y="2089.2757"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="554" y="2105.7558">Alice has Y BTC</text><rect fill="none" height="70.874" style="stroke: #D8D8D8; stroke-width: 2.0;" width="493" x="961.5" y="2124.2128"/><polygon fill="#EEEEEE" points="961.5,2124.2128,1111.5,2124.2128,1111.5,2130.2128,1101.5,2140.2128,961.5,2140.2128,961.5,2124.2128" style="stroke: #D8D8D8; stroke-width: 2.0;"/><text fill="#333333" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="976.5" y="2137.6928">Subscribe(ZMQ)</text><polygon fill="#FFFFFF" points="1033.5,2157.1498,1023.5,2161.1498,1033.5,2165.1498,1029.5,2161.1498" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1027.5" x2="1386.5" y1="2161.1498" y2="2161.1498"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1039.5" y="2157.6298">36</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86" x="1059.5" y="2157.6298">claimTxidBTC</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="1148.5" y="2157.6298">with the</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="1202.5" y="2157.6298">secret</text><polygon fill="#FFFFFF" points="1238.5,2233.0868,1248.5,2237.0868,1238.5,2241.0868,1242.5,2237.0868" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1022.5" x2="1244.5" y1="2237.0868" y2="2237.0868"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1029.5" y="2226.0353">37</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="1049.5" y="2218.5668">Create tx that claims</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="1182.5" y="2218.5668">txidLUX</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="1049.5" y="2233.5038">with the</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="1103.5" y="2233.5038">secret</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="1148.5" y="2233.5038">in scriptSig</text><polygon fill="#FFFFFF" points="1033.5,2261.9608,1023.5,2265.9608,1033.5,2269.9608,1029.5,2265.9608" style="stroke: #FFFFFF; stroke-width: 1.0;"/><line style="stroke: #FFFFFF; stroke-width: 2.0;" x1="1027.5" x2="1249.5" y1="2265.9608" y2="2265.9608"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="1039.5" y="2262.4408">38</text><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1062.5" y="2262.4408"/><rect fill="#333333" height="22" style="stroke: #D8D8D8; stroke-width: 1.0;" width="92" x="976" y="2279.8978"/><text fill="#D8D8D8" font-family="Ubuntu" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="980" y="2296.3778">Bob has X LUX</text><!--
@startuml


' Just for better look
skinparam shadowing false
skinparam defaultFontColor #d8d8d8
skinparam SequenceGroupBorderColor #d8d8d8
skinparam SequenceGroupHeaderFontColor #333333
skinparam defaultFontName "Ubuntu"
skinparam BackgroundColor #333333
skinparam sequenceArrowThickness 2
skinparam roundcorner 2
skinparam ParticipantBorderColor #black
skinparam NoteBackgroundColor #333333
skinparam NoteBorderColor  #d8d8d8
skinparam sequence {
    ArrowColor #white
    LifeLineBorderColor #d8d8d8
    ActorBorderColor #black
}

actor Alice #6b4c70
participant btcA as "Alice's BTC Node"  #6b4c70
participant luxA as "Alice's LUX Node"  #6b4c70
participant lgA as "Alice's Luxgate" #6b4c70
actor Carol as "Carol\n(Luxgate)" #888888
participant lgB as "Bob's Luxgate"  #007a74
participant luxB as "Bob's LUX Node"  #007a74
participant btcB as "Bob's BTC Node"  #007a74
actor Bob  #007a74

autonumber

Bob -> lgB : **createorder** (rpc)\nY BTC - X LUX
rnote over lgB : Save order locally
hnote over lgB: **NEW**
lgB -> Bob : ok
lgB -> Carol : **createorder**\nBTC\LUX, Y, X, Bob's address
rnote over Carol: Relay if no matches with local orders
Carol -> lgA : **createorder**\nBTC\LUX, Y, X, Bob's address
rnote over lgA : Relay to other peers
... After ...
Alice -> lgA : **createorder** (rpc)\nX LUX - Y BTC
rnote over lgA : Save order locally
hnote over lgA: **NEW**
lgA -> Alice : ok

lgA -> Carol : **createorder**\nBTC\LUX, Y, X, Alice's address
rnote over Carol: Relay if no matches with local orders
Carol -> lgB : **createorder**\nBTC\LUX, Y, X, Alice's address

rnote over lgB: **Match with local order!**

lgB -> luxB: **addnode**(Alice's address)
luxB -> luxA: connect, versions exhange
luxA -> luxB: connect, versions exhange
luxB -> lgB: ok
lgB -> lgA: **ordermatch**\nlocal order
hnote over lgB :**MATCH_FOUND**

lgA -> btcA :  getnewaddress
btcA -> lgA :  alice_btc_addr


lgA -> lgB : **reqswap**\nlocal order, alice_btc_addr
hnote over lgA : **SWAP_REQUESTED**

lgB -> luxB : getnewaddress
luxB -> lgB : bob_lux_addr

lgB -> lgA: **reqswapack**\nlocal order, bob_lux_addr
hnote over lgB : **SWAP_ACK**


rnote over lgA : Generate **secret**
lgA -> luxA: getnewaddress
luxA -> lgA: alice_lux_refund_addr

lgA -> luxA : Create tx with p2sh sending X LUX to **bob_lux_addr**\nusing **secretHash**\nor refunding to **alice_lux_refund_addr** after 40h
luxA -> lgA : txidLUX


lgA -> lgB : **swccreated**\nlocal_order, txidLUX, secretHash,\nalice_lux_refund_addr, p2sh_redeemScript

hnote over lgA : **CONTRACT_CREATED**
hnote over lgB: **CONTRACT_VERIFYING**

group Polling 
lgB -> luxB : Verify txidLUX\n**getrawtransaction**
luxB -> lgB : confirmations
' space
|||  
end

lgB -> btcB: getnewaddress
btcB -> lgB: bob_btc_refund_addr

lgB -> btcB : Create tx with p2sh sending Y BTC to **alice_btc_addr**\nusing **secretHash**\nor refunding to **bob_btc_refund_addr** after 40h
btcB -> lgB : txidBTC


lgB -> lgA: **swcack**\nlocal_order, txidBTC,\nbob_btc_refund_addr, p2sh_redeemScript

hnote over lgB: **CONTRACT_ACK**

hnote over lgA: **CONTRACT_ACK_VERIFYING**
group Polling 
lgA -> btcA : Verify txidBTC\n**getrawtransaction**
btcA -> lgA : confirmations
' space
|||  
end

lgA -> btcA: Create tx that claims **txidBTC** with the **secret** in scriptSig
btcA -> lgA: **claimTxid**
rnote over lgA: Alice has Y BTC

group Subscribe(ZMQ)
btcB -> lgB: **claimTxidBTC** with the **secret**
|||
end

lgB -> luxB: Create tx that claims **txidLUX**\nwith the **secret** in scriptSig
luxB -> lgB:
rnote over lgB: Bob has X LUX

@enduml

PlantUML version 1.2017.15(Mon Jul 03 23:45:34 NOVT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 10.0.2+13-Ubuntu-1ubuntu0.18.04.2
Operating System: Linux
OS Version: 4.15.0-36-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>